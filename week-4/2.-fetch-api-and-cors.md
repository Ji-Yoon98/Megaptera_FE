# 2. Fetch API & CORS

{% hint style="info" %}
FetchëŠ” Requestë‚˜ Responseì™€ ê°™ì€ HTTP íŒŒì´í”„ë¼ì¸ì„ êµ¬ì„±í•˜ëŠ” ìš”ì†Œë¥¼ ì¡°ì‘í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” APIì´ë‹¤.
CORSëŠ” ì²˜ìŒ ë¦¬ì†ŒìŠ¤ë¥¼ ì œê³µí•œ ë„ë©”ì¸(Origin)ì´ í˜„ì¬ ìš”ì²­í•˜ë ¤ëŠ” ë„ë©”ì¸ê³¼ ë‹¤ë¥´ë”ë¼ë„ ìš”ì²­ì„ í—ˆë½í•´ì£¼ëŠ” ì›¹ ë³´ì•ˆ ë°©ì¹¨ì´ë‹¤.

í”„ë¡ íŠ¸ì—”ë“œì—ì„œëŠ” fetch() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë°±ì—”ë“œì™€ ì—°ê²°
â†’ CORS ë¬¸ì œ ë°œìƒ â†’ í•´ê²°
{% endhint %}

### ğŸ“šë°”ë¡œê°€ê¸°

- [Fetch API](2.-fetch-api-and-cors.md#fetch-api)
- [CORS](2.-fetch-api-and-cors.md#cors)

## ğŸ“Fetch API

> [Fetch API](https://developer.mozilla.org/ko/docs/Web/API/Fetch_API)\
> [Fetch ì‚¬ìš©í•˜ê¸°](https://developer.mozilla.org/ko/docs/Web/API/Fetch_API/Using_Fetch)\
> [ReadableStream](https://developer.mozilla.org/ko/docs/Web/API/ReadableStream)\
> [í…ìŠ¤íŠ¸ ë””ì½”ë”ì™€ í…ìŠ¤íŠ¸ ì¸ì½”ë”](https://ko.javascript.info/text-decoder)

ê¸°ë³¸ì ì¸ ì‚¬ìš©ë²• test

```javascript
fetch('http://localhost:3000/products');
// â†’ Promise

await fetch('http://localhost:3000/products');
// â†’ Response

const response = await fetch('http://localhost:3000/products');
// â†’ response.bodyëŠ” ReadableStream

const reader = response.body.getReader();

const chunk = await reader.read();
// â†’ chunk.valueëŠ” Uint8Array íƒ€ì….
// â†’ ì›ë˜ëŠ” chunk.doneì´ trueì¼ ë•Œê¹Œì§€ ë°˜ë³µí•´ì•¼ í•œë‹¤.

const body = new TextDecoder().decode(chunk.value);

const data = JSON.parse(body);
```

```javascript
const response = await fetch('http://localhost:3000/products');
const data = await response.json();
```

- JSON ê¸°ë³¸ ì§€ì›</br>

```javascript
const response = fetch(url, {
    method: 'POST',
});
```

- ë‹¤ë¥¸ HTTP Methodë¥¼ ì“°ê³  ì‹¶ì„ ë•Œ

[ëª©ì°¨ğŸ”º](2.-fetch-api-and-cors.md#undefined)

## ğŸ“CORS(êµì°¨ ì¶œì²˜ ë¦¬ì†ŒìŠ¤ ê³µìœ )

> [ë™ì¼ ì¶œì²˜ ì •ì±…](https://developer.mozilla.org/ko/docs/Web/Security/Same-origin_policy)\
> [CORS](https://developer.mozilla.org/ko/docs/Web/HTTP/CORS)

ì›¹ ë¸Œë¼ìš°ì €ëŠ” Same Origin Policyì— ë”°ë¼ ì›¹ í˜ì´ì§€ì™€ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•œ ê³³(ì—¬ê¸´ REST API ì„œë²„)ì´ ì„œë¡œ ë‹¤ë¥¸ ì¶œì²˜(í¬íŠ¸ í¬í•¨)ì¼ ë•Œ ì„œë²„ì—ì„œ ì–»ì€ ê²°ê´„ ì‚¬ìš© í•  ìˆ˜ ì—†ê²Œ ë§‰ìŒ. ì„œë²„ì— ìš”ì²­í•˜ê³  ì‘ë‹µì„ ë°›ì•„ì˜¤ëŠ” ê²ƒê¹Œì§„ ì´ë¯¸ ì§„í–‰ì´ ë‹¤ ëœ ìƒí™©

- **REST API** ì„œë²„ì—ì„œ Headersì— "Access-Control-Allow-Origin" ì†ì„±ì„ ì¶”ê°€í•˜ë©´ ë¨.
- **Express**ì—ì„  [CORS ë¯¸ë“¤ì›¨ì–´](https://expressjs.com/en/resources/middleware/cors.html)ë¥¼ ì„¤ì¹˜í•´ì„œ ì‚¬ìš©í•˜ë©´ ë¨.

```bash
// íŒ¨í‚¤ì§€ ì„¤ì¹˜
npm i cors
npm i -D @types/cors
```

```typescript
// REACT-DEMO-APP main.tsx
async function main() {
    // fatch
    const url = 'http://localhost:3000/products';
    const response = await fetch(url);
    const data = await response.json();
    const {products} = data;
    console.log(products);

    const element = document.getElementById('root');
    if (!element) {
        return;
    }

    const root = ReactDOM.createRoot(element);
        root.render(<App products={products}/>);
}

// REACT-DEMO-APP app.tsx
export default function App( {products} : {
    products : Product[];
}) { 
    // ìƒëµ
}
```

```typescript
// CORS ë¯¸ë“¤ì›¨ì–´ ì‚¬ìš©
import express from 'express';
import cors from 'cors';

const app = express();

app.use(cors());
```

- ì •êµí•œ ì„¤ì •ì€ ê³µì‹ ë¬¸ì„œ ì°¸ê³ 

[ëª©ì°¨ğŸ”º](2.-fetch-api-and-cors.md#undefined)
